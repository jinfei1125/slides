---
title: "Deep dive: themes + axes + annotation"
author: "MACS 40700 <br /> University of Chicago"
output: rcfss::xaringan_wide
---

```{r setup, include = FALSE, cache = FALSE}
# generate CSS file
library(xaringanthemer)
rcfss::xaringan_theme()

# source in the default knitr options
source(here::here("R", "slide-opts.R"))

# enable panelsets and default theme
xaringanExtra::use_panelset()
# ggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))

# load basic packages
library(knitr)
library(here)
library(countdown)
library(patchwork)
```

class: inverse, middle

# Setup

---

```{r pkgs, message = FALSE, cache = FALSE}
# load packages
library(tidyverse)
library(palmerpenguins)
library(hrbrthemes)
library(ggthemes)
library(ggpomological)

# set default theme for ggplot2
ggplot2::theme_set(ggplot2::theme_gray(base_size = 16))

# set default figure parameters for knitr
knitr::opts_chunk$set(
  fig.width = 8, fig.asp = 0.618,
  fig.retina = 2, dpi = 150
)

# dplyr print min and max
options(dplyr.print_max = 6, dplyr.print_min = 6)
```

---

class: middle, inverse

# CRAP and ggplot

---

# Universal principles

.center[
.large[**C**ontrast]

.large[**R**epetition]

.large[**A**lignment]

.large[**P**roximity]
]

---

# Is that gray background okay?

```{r standard-grey, echo = FALSE, out.width = "70%"}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, color = species)) +
  geom_point(size = 2)
```

--

It adds contrast! Some people just don't like it `r emo::ji("shrug")`

---

# Applying CRAP to ggplot

We can follow CRAP principles to make big improvements to our plots

Claus Wilke's chapter covers lots of these graph-specific principles

We can apply these principles to `ggplot()` plots

---

# Like this!

.pull-left[
```{r hrbrlight, fig.show = "hide", warning = FALSE}
library(hrbrthemes)

ggplot(penguins, aes(x = bill_depth_mm,
                     y = bill_length_mm,
                     color = species)) +
  geom_point(size = 2) +
  theme_ipsum_ps() #<<
```
]
.pull-right[
```{r ref.label = "hrbrlight", echo = FALSE, warning = FALSE, out.width = "100%", fig.width = 6}
```
]

---

# And this!

.pull-left[
```{r hrbrdark, fig.show = "hide", warning = FALSE}
library(hrbrthemes)

ggplot(penguins, aes(x = bill_depth_mm,
                     y = bill_length_mm,
                     color = species)) +
  geom_point(size = 2) +
  theme_modern_rc() #<<
```
]

.pull-right[
```{r ref.label = "hrbrdark", echo = FALSE, warning = FALSE, out.width = "100%", fig.width = 6}
```
]

---

# Or this!

.pull-left[
```{r economist, fig.show = "hide", warning = FALSE}
library(hrbrthemes)

ggplot(penguins, aes(x = bill_depth_mm,
                     y = bill_length_mm,
                     color = species)) +
  geom_point(size = 2) +
  scale_color_economist() + #<<
  theme_economist() #<<
```
]

.pull-right[
```{r ref.label = "economist", echo = FALSE, warning = FALSE, out.width = "100%", fig.width = 6}
```
]

---

# And even this!

.pull-left[
```{r pomological, fig.show = "hide", warning = FALSE}
library(ggpomological)

ggplot(penguins, aes(x = bill_depth_mm,
                     y = bill_length_mm,
                     color = species)) +
  geom_point(size = 2) +
  scale_color_pomological() + #<<
  theme_pomological_fancy() #<<
```
]

.pull-right[
```{r ref.label = "pomological", echo = FALSE, warning = FALSE, out.width = "100%", fig.width = 6}
```
]

---

class: inverse, middle, center

## One magic, powerful function

--

.huge[`theme()`]

---

class: inverse, middle

# The anatomy of a `ggplot()` theme

---

# Theme system

```{r echo = FALSE}
include_graphics(path = "images/theme_elements-1024x755.png")
```

.footnote[Source: [`ggplot2` theme elements demonstration](https://henrywang.nl/ggplot2-theme-elements-demonstration/)]

---

# Theme elements

### Each element in the plot can be targeted

--

- Plot title = `plot.title`

--

- Grid lines = `panel.grid`

--

- Legend background = `legend.background`

---

# Theme functions

### Use special functions to manipulate specific elements

--

- Text-based things = `element_text()`

--

- Rectangular things (backgrounds) = `element_rect()`

--

- Line-based things (axis lines, grid lines) = `element_line()`

--

- Disable element completely = `element_blank()`

---

# How to learn `theme()`

- The `theme()` function has **94** possible arguments

- You can get hyper-specific with things like `axis.ticks.length.x.bottom`

- The only way to learn how to use `theme()` is to use it and tinker with it

---

class: inverse, middle

# .hand[Live coding] 

---

class: inverse, middle

# Axes

---

## Axis breaks

.task[
How can the following figure be improved with custom breaks in axes, if at all?
]

```{r echo = FALSE, message = FALSE, cache = TRUE}
pac_plot <- read_rds(file = "data/pac-uk-default.rds")
pac_plot
```

---

## Context matters

```{r message = FALSE, warning = FALSE, out.width = "70%"}
pac_plot +
  scale_x_continuous(breaks = seq(from = 2000, to = 2020, by = 2)) #<<
```

---

## Conciseness matters

```{r message = FALSE, warning = FALSE, out.width = "70%"}
pac_plot +
  scale_x_continuous(breaks = seq(2000, 2020, 4))
```

---

## Precision matters

```{r message = FALSE, warning = FALSE, out.width = "70%"}
pac_plot +
  scale_x_continuous(breaks = seq(2000, 2020, 4)) +
  labs(x = "Election year") #<<
```

